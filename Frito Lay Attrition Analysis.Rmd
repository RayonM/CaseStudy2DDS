---
title: "Frito Lay Analysis"
author: "Rayon M"
date: "7/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries Used in the Study

```{r echo = FALSE}

library(tidyverse)
library(GGally)
library(naniar)
library(dplyr)
library(class)
library(caret)
library(e1071)
library(ggplot2)
library(plotly)


```

# Dataset provided for use in the Study

```{r}


# Read in the Employee Dataset that will used in the Analysis.

employee_data = read.csv("C:/Users/Rayon/OneDrive/Documents/Doing DataScience/Doing Data Science/MSDS_6306_Doing-Data-Science/Unit 14 and 15 Case Study 2/CaseStudy2-data.csv")

comp_dataset = read.csv("C:/Users/Rayon/OneDrive/Documents/Doing DataScience/Doing Data Science/MSDS_6306_Doing-Data-Science/Unit 14 and 15 Case Study 2/CaseStudy2CompSet No Attrition.csv")

#view(employee_data)

```


# Classification Model
## Naive Bayes

```{r}

# Find the average accuracy, sensitivity, and specificity of the model. The sensitivity and specificity must both be >= 60%.

masterAcc = numeric(100)
massterSensitivity = numeric(100)
massterSpecificivity = numeric(100)
tseed = numeric(100)


for(seed in 1:100)
{
  set.seed(seed)
  splitPerc = 0.70
  TrainIndices = sample(1:dim(employeeData)[1],round(splitPerc * dim(employeeData)[1]))
  Train = employeeData[trainIndices,]
  Test = employeeData[-trainIndices,]
  modelAttritionYorN = naiveBayes(Train[,c("Age", "JobLevel", "MonthlyIncome", "OverTime")],factor(Train$Attrition, labels=c("No", "Yes")))
  CM = confusionMatrix(table(factor(Test$Attrition, labels = c("No", "Yes")), predict(modelAttritionYorN,Test[,c("Age", "JobLevel", "MonthlyIncome", "OverTime")])))
  masterAcc[seed] = CM$overall[1]
  massterSensitivity[seed] = CM$byClass[1]
  massterSpecificivity[seed] = CM$byClass[2]
  tseed[seed] = seed
}


mean(seed)
mean(masterAcc)
mean(massterSensitivity)
mean(massterSpecificivity)

#My Main predictors:
  #"Age", "JobLevel", "MonthlyIncome", "OverTime"# Use this one!

#Predictors:
  #"JobInvolvement", "JobLevel", "OverTime", "WorkLifeBalance" - #really good as well.
  #"Age", "DistanceFromHome",  "JobLevel", "MonthlyIncome", "TrainingTimesLastYear", "YearsAtCompany", "YearsInCurrentRole", "YearsWithCurrManager" #Not a good - Specificity low..
  #"Age", "JobLevel", "MonthlyIncome", "OverTime"# Use this one!
  #"MonthlyIncome", "PercentSalaryHike", "TotalWorkingYears", "YearsAtCompany", "YearsInCurrentRole", "YearsSinceLastPromotion", "YearsWithCurrManager" - not good.


#Test the Model


#confusionMatrix(table(factor(Test$Attrition, labels = c("No", "Yes")),
                      
                      
                      
                      
CompDataset$Attrition =  predict(modelAttritionYorN,CompDataset[,c("ID", "Age", "JobLevel", "MonthlyIncome", "OverTime")])

view(CompDataset)


```


## Regression Model

```{r}


```
